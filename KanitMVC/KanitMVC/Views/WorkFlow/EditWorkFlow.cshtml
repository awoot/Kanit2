
@{
    ViewBag.Title = "EditWorkFlow";
}

@*<h2>EditWorkFlow</h2>*@
<script src="@Url.Content("~/Scripts/CUDS/Setting/WorkFlow/EditWorkFlow.js")" type="text/javascript"></script>
@* ---------------------------- Dynamictable -------------------------- *@
@Scripts.Render("~/Scripts/js/EditableGrid/jquery.dynotable.js")
@Scripts.Render("~/Scripts/js/EditableGrid/highlight.min.js")
<div class="modal fade" id="ShowDialog" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"></div>
<div class="row">
    <div class="col-lg-12">
        <h3 class="page-header">
            <i class="fa fa-file-text-o"></i> Work Flow / Edit
        </h3>
        <div class="col-xs-9 col-sm-10 col-lg-11">
            <div class="row m-bot15">
                @*<a href="#" id="btnSave" class="btn btn-primary">Save</a>*@
                @*<a href="IndexUser.aspx" id="btnDiscard" class="btn btn-danger">Discard</a>*@
                <button type="button" id="btnSave" class="btn btn-primary" onclick="Isvalidate('Update', 'WorkFlow', @Request.Params["id"])">Save</button>
                @*<button type="button" id="btnSave" class="btn btn-primary" onclick="CreateData()">Save</button>*@
                <button type="button" id="btnDiscard" class="btn btn-danger" onclick="Redirect()">Discard</button>
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-lg-12">
        <section class="panel">
            <header class="panel-heading">
                Work Flow
            </header>
            <div class="panel-body">
                <div class="row">
                    <div class="col-xs-6 col-sm-4">
                        <div class="form-group">
                            <label class="col-sm-5 control-label">Flow Name</label>
                            <div class="col-sm-7">
                                <input id="txtFlowName" class="form-control m-bot15" type="text">
                            </div>
                        </div>
                    </div>
                    <div class="col-xs-6 col-sm-4">
                        <div class="form-group">
                            <label class="col-sm-5 control-label">Start Date</label>
                            <div class="col-sm-7">
                                <div class="input-group date" id="dtStartDate">
                                    <input type="text" class="form-control" id="txtStartDate" />
                                    <span class="input-group-addon">
                                        <span class="glyphicon glyphicon-calendar"></span>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-xs-6 col-sm-4 spandiv">
                        <div class="form-group">
                            <label class="col-sm-2 control-label">Note</label>
                            <div class="col-sm-10">
                                <textarea class="form-control m-bot15" rows="5" id="txtRemark"></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="clearfix visible-xs-block"></div>
                    <div class="col-xs-6 col-sm-4 spandiv">
                        <div class="form-group">
                            <label class="col-sm-5 control-label">Flow Detail</label>
                            <div class="col-sm-7">
                                <textarea class="form-control m-bot15" rows="3" id="txtFlowDetail"></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="col-xs-6 col-sm-4">
                        <div class="form-group">
                            <label class="col-sm-5 control-label">End Date</label>
                            <div class="col-sm-7">
                                <div class="input-group date" id="dtEndDate">
                                    <input type="text" class="form-control" id="txtEndDate" />
                                    <span class="input-group-addon">
                                        <span class="glyphicon glyphicon-calendar"></span>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-lg-12 mgr-top5">
                        <section class="panel">
                            <header class="panel-heading">
                                <div class="col-xs-7 col-sm-10 col-lg-11">Flow Condition</div>
                                <div class="col-xs-5 col-sm-2 col-lg-1">

                                </div>
                            </header>
                            <div class="table-responsive">
                                <table id="tblWorkFlow" class="table table-striped table-hover example">
                                    <thead>
                                        <tr>
                                            <th></th>
                                            <th class="text-center">No.</th>
                                            <th class="text-center">Col_val</th>
                                            <th class="text-center">Equation_val</th>
                                            <th class="text-center">Cond_val1</th>
                                            <th class="text-center">Cond_val2</th>
                                            <th class="hidecolumn">Step1</th>
                                            <th class="hidecolumn">Step2</th>
                                            <th class="hidecolumn">Step3</th>
                                            <th class="hidecolumn">Step4</th>
                                            <th class="hidecolumn">Step5</th>
                                            <th class="hidecolumn">Step6</th>
                                            <th class="text-center">Detail</th>
                                            <th class="text-center">Assign</th>
                                            @*<th></th>*@
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr class="RowCal">
                                            <td>
                                                <img class="drag-handle fa fa fa-sort" src="" alt="" />
                                            </td>
                                            <td><input class="txtNo form-control m-bot15 width50" type="text" disabled></td>
                                            <td>
                                                <select class="cmbColval form-control m-bot15 width130" id="Colval"></select>
                                            </td>
                                            <td>
                                                <select class="cmbEquationval form-control m-bot15 width110" id="Equationval"></select>
                                            </td>
                                            <td><input class="txtCondval1 form-control m-bot15" type="text" id="txtCondval1"></td>
                                            <td><input class="txtCondval2 form-control m-bot15" type="text" id="txtCondval2"></td>
                                            @*<td class="hidecolumn"><input class="txtStep1 form-control m-bot15" type="text" id="txtStep1"></td>*@
                                            <td class="hidecolumn"><input class="txtStep1 form-control m-bot15" type="text" id="txtStep1"></td>
                                            <td class="hidecolumn"><input class="txtStep2 form-control m-bot15" type="text" id="txtStep2"></td>
                                            <td class="hidecolumn"><input class="txtStep3 form-control m-bot15" type="text" id="txtStep3"></td>
                                            <td class="hidecolumn"><input class="txtStep4 form-control m-bot15" type="text" id="txtStep4"></td>
                                            <td class="hidecolumn"><input class="txtStep5 form-control m-bot15" type="text" id="txtStep5"></td>
                                            <td class="hidecolumn"><input class="txtStep6 form-control m-bot15" type="text" id="txtStep6"></td>
                                            <td class="hidecolumn"><input class="txtFullName1 form-control m-bot15" type="text" id="txtFullName1"></td>
                                            <td class="hidecolumn"><input class="txtFullName2 form-control m-bot15" type="text" id="txtFullName2"></td>
                                            <td class="hidecolumn"><input class="txtFullName3 form-control m-bot15" type="text" id="txtFullName3"></td>
                                            <td class="hidecolumn"><input class="txtFullName4 form-control m-bot15" type="text" id="txtFullName4"></td>
                                            <td class="hidecolumn"><input class="txtFullName5 form-control m-bot15" type="text" id="txtFullName5"></td>
                                            <td class="hidecolumn"><input class="txtFullName6 form-control m-bot15" type="text" id="txtFullName6"></td>
                                            <td><input class="txtDetail form-control m-bot15 text-right width450" type="text" value="" id="txtDetail"></td>
                                            <td>
                                                <div class="btn-group">
                                                    <a href="#WorkFlowDetail" data-toggle="modal" class="btn btn-default btn-sm plusicon" onclick="SetRowIndex()" onblur="SetCollumnToStep()"><img src="../img/icons/Create.png" id="list" /></a>
                                                </div>
                                            </td>
                                            <td>
                                                <div class="btn-group">
                                                    <img class="cloneRowWorkFlowDetail row-cloner fa fa-plus-circle btn btn-success" src="" alt="" />
                                                    <img class="row-remover btn btn-danger icon_close_alt2" src="" alt="" />
                                                </div>
                                            </td>
                                        </tr>
                                        <tr class="RowCal" id="add-template">
                                            <td>
                                                <img class="drag-handle fa fa fa-sort" src="" alt="" />
                                            </td>
                                            <td><input class="txtNo form-control m-bot15 width50" type="text" disabled></td>
                                            <td>
                                                <select class="cmbColval form-control m-bot15 width130" id="Colval"></select>
                                            </td>
                                            <td>
                                                <select class="cmbEquationval form-control m-bot15 width110" id="Equationval"></select>
                                            </td>
                                            <td><input class="txtCondval1 form-control m-bot15" type="text" id="txtCondval1"></td>
                                            <td><input class="txtCondval2 form-control m-bot15" type="text" id="txtCondval2"></td>
                                            @*<td class="hidecolumn"><input class="txtStep1 form-control m-bot15" type="text" id="txtStep1"></td>*@
                                            <td class="hidecolumn"><input class="txtStep1 form-control m-bot15" type="text" id="txtStep1"></td>
                                            <td class="hidecolumn"><input class="txtStep2 form-control m-bot15" type="text" id="txtStep2"></td>
                                            <td class="hidecolumn"><input class="txtStep3 form-control m-bot15" type="text" id="txtStep3"></td>
                                            <td class="hidecolumn"><input class="txtStep4 form-control m-bot15" type="text" id="txtStep4"></td>
                                            <td class="hidecolumn"><input class="txtStep5 form-control m-bot15" type="text" id="txtStep5"></td>
                                            <td class="hidecolumn"><input class="txtStep6 form-control m-bot15" type="text" id="txtStep6"></td>
                                            <td class="hidecolumn"><input class="txtFullName1 form-control m-bot15" type="text" id="txtFullName1"></td>
                                            <td class="hidecolumn"><input class="txtFullName2 form-control m-bot15" type="text" id="txtFullName2"></td>
                                            <td class="hidecolumn"><input class="txtFullName3 form-control m-bot15" type="text" id="txtFullName3"></td>
                                            <td class="hidecolumn"><input class="txtFullName4 form-control m-bot15" type="text" id="txtFullName4"></td>
                                            <td class="hidecolumn"><input class="txtFullName5 form-control m-bot15" type="text" id="txtFullName5"></td>
                                            <td class="hidecolumn"><input class="txtFullName6 form-control m-bot15" type="text" id="txtFullName6"></td>
                                            <td><input class="txtDetail form-control m-bot15 text-right width450" type="text" value="" id="Detail"></td>
                                            <td>
                                                <div class="btn-group">
                                                    <a href="#WorkFlowDetail" data-toggle="modal" class="btn btn-default btn-sm plusicon" onclick="SetRowIndex()" onblur="SetCollumnToStep()"><img src="../img/icons/Create.png" id="list" /></a>
                                                </div>
                                            </td>
                                            <td>
                                                <div class="btn-group">
                                                    <img class="cloneRowWorkFlowDetail row-cloner fa fa-plus-circle btn btn-success" src="" alt="" />
                                                    <img class="row-remover btn btn-danger icon_close_alt2" src="" alt="" />
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                                <button type="submit" class="btn btn-primary" id="add-row" onblur="SetRowIndex()" onclick="AddRowWorkFlowDetail()">+ Addrow</button>
                            </div>
                        </section>
                    </div>
                </div>
            </div>
        </section>

        <div aria-hidden="true" aria-labelledby="myModalLabel" role="dialog" tabindex="-1" id="WorkFlowDetail" class="modal fade">
            <div class="modal-dialog popup60">
                <div class="modal-content">
                    <div class="modal-header">
                        <button aria-hidden="true" data-dismiss="modal" class="close" type="button">×</button>
                        <h4 class="modal-title">Assign</h4>
                    </div>
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-xs-12 col-sm-6">
                                <div class="form-group">
                                    <label class="col-xs-12 col-sm-3 control-label mgr-top3">Step 1:</label>
                                    <div class="col-xs-12 col-sm-9 mgr-top3">
                                        <div class="input-group date">
                                            <input type="text" id="txtUser1" class="txtUser form-control" />
                                            <input type="hidden" id="hidUserID1" class="hidUserID1" />
                                            <input type="hidden" id="hidPositionName1" class="hidPositionName1" />
                                            <span class="input-group-addon">
                                                <a href="#ModalProducts" data-toggle="modal" id="Browse1" onclick="BrowseUser('1')">
                                                    <span class="fa fa-search iconcolor">
                                                    </span>
                                                </a>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-6">
                                <div class="form-group">
                                    <label class="col-xs-12 col-sm-3 control-label mgr-top3">Step 2:</label>
                                    <div class="col-xs-12 col-sm-9 mgr-top3">
                                        <div class="input-group date">
                                            <input type="text" id="txtUser2" class="txtUser form-control" />
                                            <input type="hidden" id="hidUserID2" class="hidUserID2" />
                                            <input type="hidden" id="hidPositionName2" class="hidPositionName2" />
                                            <span class="input-group-addon">
                                                <a href="#ModalProducts" data-toggle="modal" id="Browse2" onclick="BrowseUser('2')">
                                                    <span class="fa fa-search iconcolor">
                                                    </span>
                                                </a>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-6">
                                <div class="form-group">
                                    <label class="col-xs-12 col-sm-3 control-label mgr-top3">Step 3:</label>
                                    <div class="col-xs-12 col-sm-9 mgr-top3">
                                        <div class="input-group date">
                                            <input type="text" id="txtUser3" class="txtUser form-control" />
                                            <input type="hidden" id="hidUserID3" class="hidUserID3" />
                                            <input type="hidden" id="hidPositionName3" class="hidPositionName3" />
                                            <span class="input-group-addon">
                                                <a href="#ModalProducts" data-toggle="modal" id="Browse3" onclick="BrowseUser('3')">
                                                    <span class="fa fa-search iconcolor">
                                                    </span>
                                                </a>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-6">
                                <div class="form-group">
                                    <label class="col-xs-12 col-sm-3 control-label mgr-top3">Step 4:</label>
                                    <div class="col-xs-12 col-sm-9 mgr-top3">
                                        <div class="input-group date">
                                            <input type="text" id="txtUser4" class="txtUser form-control" />
                                            <input type="hidden" id="hidUserID4" class="hidUserID4" />
                                            <input type="hidden" id="hidPositionName4" class="hidPositionName4" />
                                            <span class="input-group-addon">
                                                <a href="#ModalProducts" data-toggle="modal" id="Browse4" onclick="BrowseUser('4')">
                                                    <span class="fa fa-search iconcolor">
                                                    </span>
                                                </a>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-6">
                                <div class="form-group">
                                    <label class="col-xs-12 col-sm-3 control-label mgr-top3">Step 5:</label>
                                    <div class="col-xs-12 col-sm-9 mgr-top3">
                                        <div class="input-group date">
                                            <input type="text" id="txtUser5" class="txtUser form-control" />
                                            <input type="hidden" id="hidUserID5" class="hidUserID5" />
                                            <input type="hidden" id="hidPositionName5" class="hidPositionName5" />
                                            <span class="input-group-addon">
                                                <a href="#ModalProducts" data-toggle="modal" id="Browse5" onclick="BrowseUser('5')">
                                                    <span class="fa fa-search iconcolor">
                                                    </span>
                                                </a>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-6">
                                <div class="form-group">
                                    <label class="col-xs-12 col-sm-3 control-label mgr-top3">Step 6:</label>
                                    <div class="col-xs-12 col-sm-9 mgr-top3">
                                        <div class="input-group date">
                                            <input type="text" id="txtUser6" class="txtUser form-control" />
                                            <input type="hidden" id="hidUserID6" class="hidUserID6" />
                                            <input type="hidden" id="hidPositionName6" class="hidPositionName6" />
                                            <span class="input-group-addon">
                                                <a href="#ModalProducts" data-toggle="modal" id="Browse6" onclick="BrowseUser('6')">
                                                    <span class="fa fa-search iconcolor">
                                                    </span>
                                                </a>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary" data-dismiss="modal" onclick="BindStepToCollumn()">OK</button>
                    </div>
                </div>
            </div>
        </div>

        <div aria-hidden="true" aria-labelledby="myModalLabel" role="dialog" tabindex="-1" id="ModalProducts" class="modal fade">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header1">
                        <button aria-hidden="true" data-dismiss="modal" class="close" type="button">×</button>
                        <h4 class="modal-title">User</h4>
                    </div>
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-lg-12">
                                <section class="panel">
                                    <header class="panel-heading panel-heading1">
                                        <div class="col-lg-7"></div>
                                        <div class="col-lg-5 padding7"><input id="txtSearchUser" class="form-control" placeholder="Search" type="text"></div>
                                    </header>
                                    <div class="table-responsive">
                                        <table id="tblUser" class="table table-striped table-hover">
                                            <thead>
                                                <tr>
                                                    <th>No.</th>
                                                    <th>User Name</th>
                                                    <th>Full Name</th>
                                                    <th>Email</th>
                                                    <th>Security Profile</th>
                                                </tr>
                                            </thead>
                                            @*<tbody id="resultUser">*@
                                            <tbody id="resultUser" class="tbdUser"></tbody>
                                        </table>
                                    </div>
                                </section>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div aria-hidden="true" aria-labelledby="myModalLabel" role="dialog" tabindex="-1" id="Modalcompany" class="modal fade">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header1">
                        <button aria-hidden="true" data-dismiss="modal" class="close" type="button">×</button>
                        <h4 class="modal-title">Company</h4>
                    </div>
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-lg-12">
                                <section class="panel">
                                    <header class="panel-heading panel-heading1">
                                        <div class="col-lg-7"></div>
                                        <div class="col-lg-5 padding7"><input id="searchInput" class="form-control" placeholder="Search" type="text"></div>
                                    </header>
                                    <div class="table-responsive">
                                        <table id="tblCompany" class="table table-striped table-hover">
                                            <thead>
                                                <tr>
                                                    <th>No.</th>
                                                    <th>Company Name (TH)</th>
                                                    <th>Company Type</th>
                                                    <th>Customer Segment</th>
                                                    <th>Credit Term</th>
                                                </tr>
                                            </thead>
                                            <tbody id="result">
                                                <tr>
                                                    <td>1</td>
                                                    <td>แลนด์ แอนด์ เฮ้าส์</td>
                                                    <td>Customer</td>
                                                    <td>EPC</td>
                                                    <td>30</td>
                                                </tr>
                                                <tr>
                                                    <td>2</td>
                                                    <td>บริษัท พิศนุการช่าง จำกัด</td>
                                                    <td>Supplier</td>
                                                    <td>End-User</td>
                                                    <td>60</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </section>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">

    $(document).ready(function () {
        //var input = window.location.href;
        //var after = input.split('?')[1]
        //var val = after.split('=');
        //var Isview = val[2];
        //GetCurrency();
        GetData(@Request.Params["id"]);
        //ControlEnable(Isview);
    });

</script>