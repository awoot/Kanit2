
@{
    ViewBag.Title = "View Quotation";
}

@*<h2>View Quotation</h2>*@

@Styles.Render("~/Content/kendo/styles/kendo.common-bootstrap.min.css")
@Styles.Render("~/Content/kendo/styles/kendo.bootstrap.min.css")
@Scripts.Render("~/Scripts/kendo/js/kendo.ui.core.min.js")
@Scripts.Render("~/Scripts/Common.js")


@Scripts.Render("~/Scripts/CUDS/Sell/Quotation/ViewQuotation.js")

<form id="FormQuotation">
    <div style="padding-bottom: 10px;">
        <a href="./IndexQuotation" >&lt; Back</a>
    </div>
    <div class="row">
        <div class="col-lg-12">
            <section class="panel">
                <div id="divMenu" style="display:none; padding: 10px;">
                    @*<div id="btnRecall" class="btn btn-warning" data-bind="events: {click: onRecall}">Recall</div>*@
                    <div style="display:none" id="btnEdit" class="btn btn-warning" data-bind="events: {click: onEdit}">Edit</div>
                     <div style="display:none" id="btnRecall" class="btn btn-warning" data-bind="events: {click: onRecall}">Recall</div>
                     <div style="display:none" id="btnSubmitQuote" class="btn btn-success" data-bind="events: {click: onSubmitQuote}">Submit Quote</div>
                     <div style="display:none" id="btnPending" class="btn btn-danger" data-bind="events: {click: onPending}">Pending</div>
                     <div style="display:none" id="btnWin" class="btn btn-success" data-bind="events: {click: onWin}">Win</div>
                     <div style="display:none" id="btnLoss" class="btn btn-danger" data-bind="events: {click: onLoss}">Lose</div>
                    
                </div>

                <header class="panel-heading">
                    Quotation
                </header>
                <div class="panel-body">


                    <div class="row">
                        <div class="col-md-4 col-md-offset-0">
                            <div class="row">
                                <div class="col-md-4">Quotation No.</div>
                                <div class="col-md-8">
                                    <span class="form-control m-bot15" data-bind="text: Header.QuotationNo" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-4">Your Reference</div>
                                <div class="col-md-8">
                                    <span class="form-control m-bot15" data-bind="text: Header.Ref" />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 col-md-offset-0">
                            <div class="row">
                                <div class="col-md-4">Customer</div>
                                <div class="col-md-8">
                                    <span class="form-control m-bot15" data-bind="text: Header.CompanyName" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-4">Quotation Date</div>
                                <div class="col-md-8">
                                    <span class="form-control m-bot15" data-format="dd/MM/yyyy" data-bind="text: Header.QuotationDate" />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="row">
                                <div class="col-md-4">Note</div>
                                <div class="col-md-8">
                                    <span class="form-control m-bot15" data-bind="text: Header.Remark" />
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="row">
                                <div class="col-md-4">Validity(Days)</div>
                                <div class="col-md-8">
                                    <span class="form-control m-bot15" data-bind="text: Header.Validity" />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="row">
                                <div class="col-md-4">Delivery Time(Weeks)</div>
                                <div class="col-md-8">
                                    <span class="form-control m-bot15" data-bind="text: Header.DeliveryTime" />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="row">
                                <div class="col-md-4">Payment Term(Days)</div>
                                <div class="col-md-8">
                                    <span class="form-control m-bot15" data-bind="text: Header.PaymentTerm" />
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="row">
                                <div class="col-md-4">Seller</div>
                                <div class="col-md-8">
                                    <span class="form-control m-bot15" data-bind="text: Header.Seller" />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="row">
                                <div class="col-md-4">State</div>
                                <div class="col-md-8">
                                    <label id="lblState" class="form-control m-bot15" data-bind="text: Header.State"></label>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="row">
                                <div class="col-md-4">Status</div>
                                <div class="col-md-8">
                                    <label id="lblStatus" class="form-control m-bot15" data-bind="text: Header.Status"></label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="row">
                                <div class="col-md-4">Warning Date</div>
                                <div class="col-md-8">
                                    <span class="form-control m-bot15" data-format="dd/MM/yyyy" data-bind="text: Header.WarningDate" />
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-4">Currency</div>
                                <div class="col-md-8">
                                    <span class="form-control m-bot15" data-bind="text: Header.Currency" />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="row">
                                <div class="col-md-4">Cost Sheet</div>
                                <div class="col-md-8">
                                    <div class="row">
                                        <div class="col-md-12">
                                            <a id="costSheetURL" data-bind="attr: {href: Header.CostSheet}">รายละเอียด</a>
                                        </div>
                                        <div class="col-md-12">
                                            <div class="row">
                                                <div class="col-md-12">Cost1<span class="form-control m-bot15" data-format="n2" data-bind="text: Header.Cost1"></span></div>
                                                <div class="col-md-12">SellPrice<span class="form-control m-bot15" data-format="n2" data-bind="text: Header.SellPrice"></span></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="row">
                                <div class="col-md-4">Reason</div>
                                <div class="col-md-8">
                                    <span class="form-control m-bot15" data-bind="text: Header.Reason" />
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="row">
                                <div class="col-md-4">Inco Term</div>
                                <div class="col-md-8">
                                    <span class="form-control m-bot15" data-bind="text: Header.IncoTerm" />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-8">
                            <span class="form-control m-bot15" data-bind="text: Header.IncoTermDetail" />
                        </div>
                    </div>



                    <!----------------------------------------->

                    <div class="row">
                        <div class="col-lg-12">
                            <section class="panel">
                                <!--<div class="col-lg-6"></div>-->
                                <div id="divProductDetail">

                                    <header class="panel-heading">
                                        <div class="col-xs-7 col-sm-10 col-lg-11">Description</div>
                                    </header>
                                    <div class="table-responsive">
                                        <table style="width: 100%" id="tblCompany" class="table table-striped table-hover">
                                            <thead>
                                                <tr>
                                                    <th style="width: 40px;">No.</th>
                                                    <th style="width: 80px;">Line No.</th>
                                                    <th style="width: 130px;">Product</th>
                                                    <th style="">Description</th>
                                                    <th style="width: 90px;">Quantity</th>
                                                    <th style="width: 60px;">Unit</th>
                                                    <th style="width: 100px;" class="text-center">Unit Price</th>
                                                    <th style="width: 100px;" class="text-center">Amount</th>
                                                </tr>
                                            </thead>
                                            <tbody data-template="templateProductDetail" data-bind="source: Detail"></tbody>
                                            <tbody>
                                                <tr>
                                                    <td colspan="7">Sub Total</td>
                                                    <td colspan="2" class="width50">
                                                        <label class="width100 text-right" data-format="n2" data-bind="text: Header.SubTotal" />
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td colspan="7">Discount</td>
                                                    <td colspan="2" class="width100">
                                                        <label class="width100 text-right" data-format="n2" data-bind="text: Header.Discount" />
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td colspan="7">Total</td>
                                                    <td colspan="2" class="width100">
                                                        <label class="width100 text-right" data-format="n2" data-bind="text: Header.Total" />
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td colspan="7">
                                                        <div class="floatleft mgn-right5">Vat(%)</div>
                                                        <span data-format="n0" data-bind="text: Header.Vat"></span>
                                                    </td>
                                                    <td colspan="2" class="width100">
                                                        <label class="width100 text-right" data-format="n2" type="text" data-bind="text: Header.VatValue" />
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td colspan="7" class="fontbold">Net Total</td>
                                                    <td colspan="2" class="width100">
                                                        <label class="width100 text-right" data-format="n2" data-bind="text: Header.NetTotal" />
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </section>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-lg-12">
                            <section class="panel">
                                <header class="panel-heading">
                                    <div class="col-xs-7 col-sm-10 col-lg-11">Work Flow</div>
                                    <div class="col-xs-5 col-sm-2 col-lg-1">

                                    </div>
                                </header>
                                <div class="table-responsive">
                                    <table id="tblCompany" class="table table-striped table-hover">
                                        <thead>
                                            <tr>
                                                <th>No.</th>
                                                <th>Full Name</th>
                                                <th>Position</th>
                                                <th>Task</th>
                                                <th>Assigned Data</th>
                                                <th>Action</th>
                                                <th>Action Data</th>
                                                <th width="150px;" colspan="3" class="text-center"><i class="icon_cogs"></i> Action</th>
                                            </tr>
                                        </thead>
                                        <tbody data-template="templateWorkFlowDetail" data-bind="source: WorkFlow"></tbody>
                                    </table>
                                </div>
                            </section>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-lg-12">
                            <section class="panel">
                                <header class="panel-heading">
                                    <div class="col-xs-7 col-sm-10 col-lg-11">History</div>
                                    <div class="col-xs-5 col-sm-2 col-lg-1">
                                    </div>
                                </header>
                                <div class="table-responsive" style="overflow: scroll; height: 140px;">
                                    <table id="tblCompany" class="table table-striped table-hover">
                                        <tbody data-template="quotationHistoryTemplate" data-bind="source: History"></tbody>
                                    </table>
                                </div>
                            </section>
                        </div>
                    </div>
                </div>
            </section>


        </div>
    </div>
</form>

<script>
    $(document).ready(function (e) {
        GetData(@Request.Params["id"]);
    })
</script>

<script id="templateProductDetail" type="text/template">
    <tr>
        <td><span data-bind="text: No" /></td>
        <td><span data-bind="text: LineNo" /></td>
        <td><span data-bind="text: ProductCode" /></td>
        <td><span data-bind="text: Description" /></td>
        <td style="text-align: right"><span data-format="n0" data-bind="text: Quantity" /></td>
        <td><span data-bind="text: UnitName" /></td>
        <td style="text-align: right"><span data-format="n2" data-bind="text: UnitPrice" /></td>
        <td style="text-align: right"><span data-format="n2" data-bind="text: Amount" /></td>
    </tr>
</script>

<script id="templateWorkFlowDetail" type="text/template">
    <tr>
        <td><span data-bind="text: Step" /></td>
        <td><span data-bind="text: AssignedToFullName" /></td>
        <td><span data-bind="text: AssignedToPosition" /></td>
        <td><span data-bind="text: Title" /></td>
        <td><span data-format="dd/MM/yyyy" data-bind="text: AssignedDate" /></td>
        <td><span data-format="dd/MM/yyyy" data-bind="text: CompletedDate" /></td>
        <td><span data-bind="text: Action" /></td>
        <td>
            #if(CanRecall) {#
            <div class="btn btn-success" data-bind="events: {click: onRecall}"><i class="fa fa-reply"></i></div>
            #}#
            @*#if(CanEdit) {#
            <div class="btn btn-send" data-bind="events: {click: onEdit}"><i class="fa fa-pencil" aria-hidden="true"></i></div>
            #}#*@
            #if(CanApprove) {#
            <div class="btn btn-success" data-bind="events: {click: onApprove}"><i class="fa fa-check-square-o"></i></div>
            <div class="btn btn-danger" data-bind="events: {click: onReject}"><i class="icon_close_alt2"></i></div>
            #}#
        </td>
    </tr>
</script>

<script id="quotationHistoryTemplate" type="text/template">
    <tr>
        <td style="width: 150px;">
            <span data-format="dd/MM/yyyy HH:mm:ss" data-bind="text: CreatedDate" />
        </td>
        <td>
            <span data-bind="text: CreatedByDisplayName" /> &gt; <span data-bind="text: Detail" />
        </td>
    </tr>
</script>